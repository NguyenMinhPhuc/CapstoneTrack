
{
  "entities": {
    "UserAccount": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserAccount",
      "type": "object",
      "description": "Represents a user account within the CapstoneTrack system, differentiating user roles.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user account."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user account.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "Role of the user account.",
          "enum": [
            "admin",
            "supervisor",
            "student"
          ]
        },
        "status": {
          "type": "string",
          "description": "The status of the user account.",
          "enum": [
            "active",
            "pending",
            "disabled"
          ]
        },
        "studentId": {
          "type": "string",
          "description": "Reference to Student entity, if the user is a student. (Relationship: UserAccount 1:1 Student)"
        },
        "supervisorId": {
          "type": "string",
          "description": "Reference to Supervisor entity, if the user is a supervisor. (Relationship: UserAccount 1:1 Supervisor)"
        }
      },
      "required": [
        "id",
        "email",
        "role",
        "status"
      ]
    },
    "Student": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Student",
      "type": "object",
      "description": "Represents a student within the CapstoneTrack system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the student."
        },
        "studentId": {
          "type": "string",
          "description": "The official student ID number."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the student."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the student."
        },
        "major": {
          "type": "string",
          "description": "Major of the student."
        },
        "enrollmentYear": {
          "type": "number",
          "description": "Year the student enrolled.",
          "format": "number"
        },
        "className": {
          "type": "string",
          "description": "The class name of the student (e.g., '22SE111')."
        },
        "phone": {
          "type": "string",
          "description": "The phone number of the student."
        },
        "CCCD": {
          "type": "string",
          "description": "The citizen identification card number of the student."
        },
        "status": {
            "type": "string",
            "description": "The academic status of the student.",
            "enum": ["studying", "reserved", "dropped_out", "graduated"]
        }
      },
      "required": [
        "id",
        "studentId",
        "firstName",
        "lastName",
        "major",
        "enrollmentYear",
        "status"
      ]
    },
    "Supervisor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Supervisor",
      "type": "object",
      "description": "Represents a supervisor within the CapstoneTrack system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the supervisor."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the supervisor."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the supervisor."
        },
        "department": {
          "type": "string",
          "description": "Department of the supervisor."
        },
        "facultyRank": {
          "type": "string",
          "description": "The faculty rank of the supervisor."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "department"
      ]
    },
    "DefenseSession": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DefenseSession",
      "type": "object",
      "description": "Represents a period for organizing project defenses and/or internship reports.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the defense session."
        },
        "name": {
          "type": "string",
          "description": "Name of the defense session (e.g., 'Spring 2024 Defense')."
        },
        "sessionType": {
          "type": "string",
          "description": "The type of the session.",
          "enum": ["graduation", "internship", "combined"]
        },
        "startDate": {
          "type": "string",
          "description": "The start date of the session.",
          "format": "date"
        },
        "expectedReportDate": {
          "type": "string",
          "description": "The expected date for the final defense reports.",
          "format": "date"
        },
        "registrationDeadline": {
          "type": "string",
          "description": "The deadline for students to register for this defense session.",
          "format": "date"
        },
        "description": {
          "type": "string",
          "description": "A brief description of the session."
        },
        "zaloGroupLink": {
          "type": "string",
          "description": "URL link to the Zalo group for this session."
        },
        "status": {
          "type": "string",
          "description": "The current status of the defense session.",
          "enum": [
            "upcoming",
            "ongoing",
            "completed"
          ]
        },
        "companyIds": {
            "type": "array",
            "description": "A list of InternshipCompany IDs associated with this session.",
            "items": {
                "type": "string"
            }
        },
        "councilGraduationRubricId": {
          "type": "string",
          "description": "Reference to the Rubric used for graduation defense by the council in this session."
        },
        "councilInternshipRubricId": {
          "type": "string",
          "description": "Reference to the Rubric used for internship evaluation by the council in this session."
        },
        "supervisorGraduationRubricId": {
          "type": "string",
          "description": "Reference to the Rubric used for graduation defense by the project supervisor."
        },
        "companyInternshipRubricId": {
          "type": "string",
          "description": "Reference to the Rubric used for internship evaluation by the company supervisor."
        },
        "graduationCouncilWeight": {
          "type": "number",
          "description": "The weight of the council's grade in the final graduation score (0-100)."
        },
        "internshipCouncilWeight": {
          "type": "number",
          "description": "The weight of the council's grade in the final internship score (0-100)."
        }
      },
      "required": [
        "id",
        "name",
        "sessionType",
        "startDate",
        "expectedReportDate",
        "registrationDeadline",
        "status"
      ]
    },
    "DefenseSessionRegistration": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DefenseSessionRegistration",
      "type": "object",
      "description": "Represents a student's registration for a specific defense session, including project and internship details.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the registration."
        },
        "sessionId": {
          "type": "string",
          "description": "Reference to the DefenseSession this registration belongs to."
        },
        "studentDocId": {
          "type": "string",
          "description": "Reference to the student's document ID in the 'students' collection."
        },
        "studentId": {
          "type": "string",
          "description": "The official student ID number (e.g., 122001306)."
        },
        "studentName": {
          "type": "string",
          "description": "Full name of the student for display purposes."
        },
        "registrationDate": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the registration was created."
        },
        "projectTitle": {
          "type": "string",
          "description": "The title of the student's graduation project."
        },
        "projectRegistrationStatus": {
          "type": "string",
          "description": "The status of the student's project topic registration, confirmed by the supervisor.",
          "enum": ["pending", "approved", "rejected"]
        },
        "proposalStatus": {
          "type": "string",
          "description": "The status of the project proposal (thuyết minh) submitted by the student.",
          "enum": ["not_submitted", "pending_approval", "approved", "rejected"]
        },
        "proposalLink": {
            "type": "string",
            "format": "uri",
            "description": "A URL link to the full graduation project proposal document."
        },
        "summary": {
          "type": "string",
          "description": "A brief summary of the graduation project."
        },
        "objectives": {
          "type": "string",
          "description": "The objectives of the graduation project."
        },
        "expectedResults": {
          "type": "string",
          "description": "The expected results of the graduation project."
        },
        "implementationPlan": {
            "type": "string",
            "description": "The detailed implementation plan for the project."
        },
        "reportLink": {
          "type": "string",
          "format": "uri",
          "description": "A URL link to the full graduation project report."
        },
        "reportStatus": {
            "type": "string",
            "description": "The status of the final report submission.",
            "enum": ["not_submitted", "pending_approval", "approved", "rejected"]
        },
        "supervisorId": {
            "type": "string",
            "description": "Reference to the graduation project supervisor's document ID."
        },
        "supervisorName": {
          "type": "string",
          "description": "The name of the graduation project supervisor."
        },
        "internshipSupervisorId": {
            "type": "string",
            "description": "Reference to the internship supervisor's document ID."
        },
        "internshipSupervisorName": {
          "type": "string",
          "description": "The name of the internship supervisor."
        },
        "graduationStatus": {
          "type": "string",
          "description": "The registration status for the graduation defense.",
          "enum": ["reporting", "exempted", "withdrawn", "not_reporting"]
        },
        "graduationStatusNote": {
            "type": "string",
            "description": "A note explaining the reason for the 'withdrawn' or other status for graduation."
        },
        "graduationExemptionDecisionNumber": {
          "type": "string",
          "description": "The official number of the graduation exemption decision document."
        },
        "graduationExemptionDecisionDate": {
          "type": "string",
          "format": "date",
          "description": "The date when the graduation exemption decision was made."
        },
        "graduationExemptionProofLink": {
          "type": "string",
          "format": "uri",
          "description": "A URL link to the proof document for the graduation exemption."
        },
        "internshipStatus": {
          "type": "string",
          "description": "The registration status for the internship report.",
          "enum": ["reporting", "exempted", "withdrawn", "not_reporting"]
        },
        "internshipStatusNote": {
            "type": "string",
            "description": "A note explaining the reason for the 'withdrawn' or other status for internship."
        },
        "internshipExemptionDecisionNumber": {
          "type": "string",
          "description": "The official number of the internship exemption decision document."
        },
        "internshipExemptionDecisionDate": {
          "type": "string",
          "format": "date",
          "description": "The date when the internship exemption decision was made."
        },
        "internshipExemptionProofLink": {
          "type": "string",
          "format": "uri",
          "description": "A URL link to the proof document for the internship exemption."
        },
        "subCommitteeId": {
            "type": "string",
            "description": "Reference to the DefenseSubCommittee this registration is assigned to."
        },
        "internship_companyName": {
            "type": "string",
            "description": "Name of the internship company."
        },
        "internship_companyAddress": {
            "type": "string",
            "description": "Address of the internship company."
        },
        "internship_companySupervisorName": {
            "type": "string",
            "description": "Name of the supervisor at the internship company."
        },
        "internship_companySupervisorPhone": {
            "type": "string",
            "description": "Phone number of the supervisor at the internship company."
        },
        "internship_registrationFormLink": {
            "type": "string",
            "format": "uri",
            "description": "URL to the internship registration form."
        },
        "internship_commitmentFormLink": {
            "type": "string",
            "format": "uri",
            "description": "URL to the self-arranged internship commitment form."
        },
        "internship_acceptanceLetterLink": {
            "type": "string",
            "format": "uri",
            "description": "URL to the internship acceptance letter from the company."
        },
        "internship_feedbackFormLink": {
            "type": "string",
            "format": "uri",
            "description": "URL to the feedback form from the company."
        },
        "internship_reportLink": {
            "type": "string",
            "format": "uri",
            "description": "URL to the full internship report."
        },
         "internshipRegistrationStatus": {
          "type": "string",
          "description": "The approval status of the student's internship registration by an admin.",
          "enum": ["pending", "approved", "rejected"]
        }
      },
      "required": [
        "id",
        "sessionId",
        "studentDocId",
        "studentId",
        "studentName",
        "registrationDate",
        "graduationStatus",
        "internshipStatus"
      ]
    },
     "DefenseCouncil": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DefenseCouncil",
      "type": "object",
      "description": "Represents a member of the defense council for a specific graduation session.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the council member entry."
        },
        "sessionId": {
          "type": "string",
          "description": "Reference to the DefenseSession this council belongs to."
        },
        "supervisorId": {
          "type": "string",
          "description": "Reference to the supervisor's document ID in the 'supervisors' collection."
        },
        "name": {
            "type": "string",
            "description": "Full name of the supervisor for display purposes."
        },
        "role": {
          "type": "string",
          "description": "Role of the member within the council.",
          "enum": ["President", "Vice President", "Secretary", "Member"]
        }
      },
      "required": ["id", "sessionId", "supervisorId", "name", "role"]
    },
    "DefenseSubCommittee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DefenseSubCommittee",
      "type": "object",
      "description": "Represents a sub-committee or panel within a graduation defense session.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the sub-committee."
        },
        "sessionId": {
          "type": "string",
          "description": "Reference to the DefenseSession this sub-committee belongs to."
        },
        "name": {
          "type": "string",
          "description": "Name of the sub-committee (e.g., 'Tiểu ban 1 - CNTT')."
        },
        "description": {
          "type": "string",
          "description": "Optional description for notes like room or time."
        },
        "members": {
            "type": "array",
            "description": "A list of members in this sub-committee.",
            "items": {
                "type": "object",
                "properties": {
                    "supervisorId": {"type": "string"},
                    "name": {"type": "string"},
                    "role": {
                        "type": "string",
                        "enum": ["Head", "Secretary", "Commissioner"]
                    }
                },
                "required": ["supervisorId", "name", "role"]
            }
        }
      },
      "required": ["id", "sessionId", "name", "members"]
    },
    "Rubric": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Rubric",
        "type": "object",
        "description": "Defines a grading rubric for evaluating projects.",
        "properties": {
            "id": {"type": "string"},
            "name": {"type": "string", "description": "Name of the rubric (e.g., 'Final Project Defense Rubric')."},
            "description": {"type": "string", "description": "A brief description of the rubric's purpose."},
            "criteria": {
                "type": "array",
                "description": "The list of criteria that make up this rubric.",
                "items": {
                    "type": "object",
                    "properties": {
                        "id": {"type": "string"},
                        "name": {"type": "string", "description": "Name of the criterion (e.g., 'Problem Statement')."},
                        "description": {"type": "string", "description": "Detailed explanation of the criterion."},
                        "maxScore": {"type": "number", "description": "The maximum possible score for this criterion."},
                        "PLO": {"type": "string", "description": "Program Learning Outcome."},
                        "PI": {"type": "string", "description": "Performance Indicator."},
                        "CLO": {"type": "string", "description": "Course Learning Outcome."}
                    },
                    "required": ["id", "name", "maxScore"]
                }
            }
        },
        "required": ["id", "name", "criteria"]
    },
    "Evaluation": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Evaluation",
        "type": "object",
        "description": "Stores a single evaluation of a student's registration by a supervisor.",
        "properties": {
            "id": {"type": "string"},
            "sessionId": {"type": "string", "description": "Reference to the defense session."},
            "registrationId": {"type": "string", "description": "Reference to the student's registration for the session."},
            "evaluatorId": {"type": "string", "description": "The supervisor's ID who performed the evaluation."},
            "rubricId": {"type": "string", "description": "Reference to the rubric used for this evaluation."},
            "evaluationType": {
                "type": "string",
                "description": "The type of evaluation (e.g., graduation or internship).",
                "enum": ["graduation", "internship"]
            },
            "scores": {
                "type": "array",
                "description": "The scores given for each criterion.",
                "items": {
                    "type": "object",
                    "properties": {
                        "criterionId": {"type": "string"},
                        "score": {"type": "number"}
                    },
                    "required": ["criterionId", "score"]
                }
            },
            "totalScore": {"type": "number"},
            "comments": {"type": "string", "description": "General comments from the evaluator."},
            "evaluationDate": {"type": "string", "format": "date-time"}
        },
        "required": ["id", "sessionId", "registrationId", "evaluatorId", "rubricId", "evaluationType", "scores", "totalScore", "evaluationDate"]
    },
    "ProjectTopic": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectTopic",
      "type": "object",
      "description": "Represents a project topic proposed by a supervisor for a specific defense session.",
      "properties": {
        "id": { "type": "string" },
        "sessionId": { "type": "string", "description": "Reference to the DefenseSession." },
        "supervisorId": { "type": "string", "description": "The ID of the supervisor who proposed the topic." },
        "supervisorName": { "type": "string", "description": "The name of the supervisor." },
        "title": { "type": "string", "description": "The title of the project." },
        "field": { "type": "string", "description": "The field or category of the project topic." },
        "summary": { "type": "string", "description": "A brief summary of the project." },
        "objectives": { "type": "string", "description": "The objectives of the project." },
        "expectedResults": { "type": "string", "description": "The expected results of the project." },
        "maxStudents": { "type": "number", "description": "Maximum number of students allowed (1 or 2).", "enum": [1, 2] },
        "status": {
          "type": "string",
          "description": "The current status of the topic.",
          "enum": ["pending", "approved", "rejected", "taken"]
        }
      },
      "required": ["id", "sessionId", "supervisorId", "supervisorName", "title", "summary", "maxStudents", "status"]
    },
    "WeeklyProgressReport": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "WeeklyProgressReport",
        "type": "object",
        "description": "Stores a student's weekly progress report for their project.",
        "properties": {
            "id": {"type": "string"},
            "registrationId": {"type": "string", "description": "Reference to the student's registration."},
            "studentId": {"type": "string", "description": "The student's user ID."},
            "supervisorId": {"type": "string", "description": "The supervisor's user ID."},
            "sessionId": {"type": "string", "description": "The session ID."},
            "weekNumber": {"type": "number", "description": "The week number of the report within the session."},
            "submissionDate": {"type": "string", "format": "date-time"},
            "workDone": {"type": "string", "description": "Content of work done this week."},
            "nextWeekPlan": {"type": "string", "description": "Plan for the next week."},
            "proofLink": {
                "type": "string",
                "format": "uri",
                "description": "A URL link to a proof image or document for the week's work."
            },
            "status": {
                "type": "string",
                "enum": ["pending_review", "approved", "rejected"],
                "description": "The review status of the report."
            },
            "supervisorComments": {"type": "string", "description": "Optional comments from the supervisor."},
            "reviewDate": {"type": "string", "format": "date-time", "description": "When the report was reviewed."}
        },
        "required": ["id", "registrationId", "studentId", "supervisorId", "sessionId", "weekNumber", "submissionDate", "workDone", "nextWeekPlan", "status"]
    },
    "SystemSettings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SystemSettings",
      "type": "object",
      "description": "Stores global system settings and feature flags.",
      "properties": {
        "enableOverallGrading": {
          "type": "boolean",
          "description": "If true, allows graders to input an overall score which is then distributed among criteria."
        },
        "allowStudentRegistration": {
          "type": "boolean",
          "description": "If true, allows new students to register for an account."
        },
        "allowEditingApprovedProposal": {
          "type": "boolean",
          "description": "If true, allows students to edit their proposals even after they have been approved by the supervisor."
        },
        "forceOpenReportSubmission": {
          "type": "boolean",
          "description": "If true, allows students to submit their final reports at any time, overriding the default submission window."
        },
        "requireReportApproval": {
          "type": "boolean",
          "description": "If true, final reports submitted by students must be approved by their supervisor."
        }
      }
    },
    "InternshipCompany": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InternshipCompany",
      "type": "object",
      "description": "Represents a company or organization offering internship opportunities.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the company." },
        "name": { "type": "string", "description": "The official name of the company." },
        "address": { "type": "string", "description": "The physical address of the company." },
        "description": { "type": "string", "description": "A brief description of the company, its industry, and what it does." },
        "website": { "type": "string", "format": "uri", "description": "The company's official website." },
        "contactName": { "type": "string", "description": "Name of the primary contact person (e.g., HR manager)." },
        "contactEmail": { "type": "string", "format": "email", "description": "Email address of the contact person." },
        "contactPhone": { "type": "string", "description": "Phone number of the contact person." }
      },
      "required": ["id", "name"]
    },
    "EarlyInternship": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "EarlyInternship",
      "type": "object",
      "description": "Represents a record for a student undertaking an internship before an official reporting session.",
      "properties": {
        "id": { "type": "string" },
        "studentId": { "type": "string", "description": "Reference to the student's document ID." },
        "studentName": { "type": "string", "description": "Full name of the student for display." },
        "studentIdentifier": { "type": "string", "description": "The official student ID number (e.g. 122001306)." },
        "companyName": { "type": "string", "description": "Name of the internship company." },
        "companyAddress": { "type": "string", "description": "Address of the internship company." },
        "supervisorName": { "type": "string", "description": "Name of the supervisor at the company." },
        "startDate": { "type": "string", "format": "date", "description": "The start date of the internship." },
        "endDate": { "type": "string", "format": "date", "description": "The end date of the internship." },
        "proofLink": { "type": "string", "format": "uri", "description": "URL to a proof document (e.g., acceptance letter)." },
        "status": {
          "type": "string",
          "description": "The current status of the early internship.",
          "enum": ["ongoing", "completed", "cancelled"]
        }
      },
      "required": ["id", "studentId", "studentName", "studentIdentifier", "companyName", "startDate", "status"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "rules": "rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /{document=**} {\n      allow read, write: if request.auth != null;\n    }\n  }\n}\n\n",
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserAccount"
      },
      "description": "Stores user account information including their role."
    },
    "/students/{studentId}": {
      "schema": {
        "$ref": "#/entities/Student"
      },
      "description": "Stores detailed information about students."
    },
    "/supervisors/{supervisorId}": {
      "schema": {
        "$ref": "#/entities/Supervisor"
      },
      "description": "Stores detailed information about supervisors."
    },
    "/defenseSessions/{sessionId}": {
      "schema": {
        "$ref": "#/entities/DefenseSession"
      },
      "description": "Stores information about defense sessions."
    },
    "/defenseRegistrations/{registrationId}": {
      "schema": {
        "$ref": "#/entities/DefenseSessionRegistration"
      },
      "description": "Stores student registrations for all defense sessions."
    },
     "/defenseSessions/{sessionId}/council/{councilMemberId}": {
      "schema": {
        "$ref": "#/entities/DefenseCouncil"
      },
      "description": "Stores the members of the main defense council for a specific session."
    },
    "/defenseSessions/{sessionId}/subCommittees/{subCommitteeId}": {
      "schema": {
        "$ref": "#/entities/DefenseSubCommittee"
      },
      "description": "Stores the sub-committees (panels) for a specific defense session."
    },
    "/projectTopics/{topicId}": {
        "schema": {
            "$ref": "#/entities/ProjectTopic"
        },
        "description": "Stores all project topics proposed by supervisors across all sessions."
    },
    "/rubrics/{rubricId}": {
        "schema": {
            "$ref": "#/entities/Rubric"
        },
        "description": "Stores the grading rubric templates."
    },
    "/evaluations/{evaluationId}": {
        "schema": {
            "$ref": "#/entities/Evaluation"
        },
        "description": "Stores individual evaluation records from supervisors."
    },
    "/weeklyProgressReports/{reportId}": {
        "schema": {
            "$ref": "#/entities/WeeklyProgressReport"
        },
        "description": "Stores students' weekly progress reports."
    },
    "/systemSettings/{settingId}": {
      "schema": {
        "$ref": "#/entities/SystemSettings"
      },
      "description": "Stores global system-wide settings and feature flags."
    },
    "/internshipCompanies/{companyId}": {
        "schema": {
            "$ref": "#/entities/InternshipCompany"
        },
        "description": "Stores information about companies offering internships."
    },
    "/earlyInternships/{internshipId}": {
      "schema": {
        "$ref": "#/entities/EarlyInternship"
      },
      "description": "Stores records of students undertaking internships before an official session."
    }
  }
}

    